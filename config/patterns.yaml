# ==============================================================================
# UNIFIED DEFENSE - Security Configuration
# Defines protected paths, dangerous commands, and safe zones
# ==============================================================================

# ------------------------------------------------------------------------------
# GLOBAL SETTINGS
# ------------------------------------------------------------------------------
settings:
  # Mode: "blocklist" (default) or "whitelist"
  # - blocklist: Block only what's in protected_paths/dangerous_commands
  # - whitelist: Block EVERYTHING except what's in safe_zones (paranoid mode)
  mode: "blocklist"
  
  # Logging: Enable to write all decisions to ~/.claude/defense.log
  logging: true
  log_file: "~/.claude/defense.log"

# ------------------------------------------------------------------------------
# PROTECTED PATHS
# Glob patterns for paths that should be protected from Claude's access
# Levels:
#   - block: Block both read and write access
#   - read_only: Allow read, block write
#   - allow: Explicitly allow (overrides other rules)
# ------------------------------------------------------------------------------
protected_paths:
  # CRITICAL: Secrets and credentials (block completely)
  - pattern: "**/.env"
    level: block
    reason: "Environment files may contain secrets"
  - pattern: "**/.env.*"
    level: block
    reason: "Environment files may contain secrets"
  - pattern: "~/.ssh/**"
    level: block
    reason: "SSH keys and configuration"
  - pattern: "~/.aws/**"
    level: block
    reason: "AWS credentials"
  - pattern: "~/.gnupg/**"
    level: block
    reason: "GPG keys"
  - pattern: "**/*.pem"
    level: block
    reason: "Private key files"
  - pattern: "**/*.key"
    level: block
    reason: "Private key files"
  - pattern: "**/id_rsa*"
    level: block
    reason: "SSH private keys"
  - pattern: "**/id_ed25519*"
    level: block
    reason: "SSH private keys"
  - pattern: "~/.netrc"
    level: block
    reason: "Network credentials"
  - pattern: "~/.npmrc"
    level: block
    reason: "NPM tokens"
  - pattern: "~/.pypirc"
    level: block
    reason: "PyPI tokens"

  # SYSTEM: Read-only protection
  - pattern: "/etc/**"
    level: read_only
    reason: "System configuration"
  - pattern: "/usr/**"
    level: read_only
    reason: "System binaries"
  - pattern: "/bin/**"
    level: read_only
    reason: "System binaries"
  - pattern: "/sbin/**"
    level: read_only
    reason: "System binaries"
  - pattern: "/var/**"
    level: read_only
    reason: "System variable data"

# ------------------------------------------------------------------------------
# DANGEROUS COMMANDS
# Regex patterns for Bash commands that should be blocked
# ------------------------------------------------------------------------------
dangerous_commands:
  - pattern: "rm -rf /"
    reason: "Recursive force delete from root"
  - pattern: "rm -rf ~"
    reason: "Recursive force delete from home"
  - pattern: "rm -rf *"
    reason: "Recursive force delete wildcard"
  - pattern: "rm -rf --no-preserve-root"
    reason: "Force delete bypassing safety"
  - pattern: "mkfs."
    reason: "Filesystem format command"
  - pattern: "dd if=.* of=/dev/"
    reason: "Direct disk write"
  - pattern: "chmod 777"
    reason: "Overly permissive file permissions"
  - pattern: "curl.*|.*sh"
    reason: "Pipe curl to shell"
  - pattern: "wget.*|.*sh"
    reason: "Pipe wget to shell"
  - pattern: "> /dev/sda"
    reason: "Overwrite disk device"
  - pattern: "sudo rm -rf"
    reason: "Sudo recursive delete"
  - pattern: ":(){:|:&};:"
    reason: "Fork bomb"

# ------------------------------------------------------------------------------
# SAFE ZONES
# Glob patterns for paths that are explicitly allowed
# These take precedence over protected_paths
# ------------------------------------------------------------------------------
safe_zones:
  - pattern: "/tmp/**"
    reason: "Temporary files"
  - pattern: "/var/tmp/**"
    reason: "Temporary files"
  # Add your project directories here:
  # - pattern: "~/projects/**"
  #   reason: "Personal projects"
